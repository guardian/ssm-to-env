regions: [eu-west-1]
stacks: [deploy]
deployments:
  ssm-to-env:
    type: aws-lambda-layer
    dependencies: [cdk-cloudformation]
    actions:
      - uploadLayer
      - updateLayer
    parameters:
      fileName: ssm-to-env.zip
      layerName: ssm-to-env-layer
  ssm-to-env-lambda-example:
    type: aws-lambda
    dependencies: [cdk-cloudformation, aws-lambda-layer]
    actions:
      - uploadLambda
      - updateLambda
    parameters:
      fileName: ssm-to-env-lambda-example.zip
      lookupByTags: true
  cdk-cloudformation:
    type: cloud-formation
    sources:
      - packages/cdk/cdk.out/SsmToEnv-CODE.template.json
    app: ssm-to-env
    parameters:
      prependStackToCloudFormationStackName: false
      cloudFormationStackName: ssm-to-env
      templateStagePaths:
        CODE: SsmToEnv-CODE.template.json
      cloudFormationStackByTags: false